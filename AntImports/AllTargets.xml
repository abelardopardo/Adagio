<?xml version="1.0" encoding="UTF-8"?>

<!--
  Copyright (C) 2008 Carlos III University of Madrid
  This file is part of the ADA: Agile Distributed Authoring Toolkit

  This program is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 51 Franklin Street, Fifth Floor
  Boston, MA  02110-1301, USA.

-->

<project name="Gather all target definitions" default="execute">

  <import file="InitialCheck.xml"/>
  <import file="ExtraAnt.xml"/>

<!--   <import file="Mergestyles.xml"/> -->
<!--   <import file="Xsltproc.xml"/> -->
<!--   <import file="Cleaning.xml"/> -->
<!--   <import file="Convert.xml"/> -->
<!--   <import file="Dblatex.xml"/> -->
<!--   <import file="Dvi2bitmap.xml"/> -->
<!--   <import file="Dvips.xml"/> -->
<!--   <import file="Latex.xml"/> -->
<!--   <import file="Exam.xml"/> -->
<!--   <import file="ExportControl.xml"/> -->
<!--   <import file="Export.xml"/> -->
<!--   <import file="Copyfiles.xml"/> -->
<!--   <import file="Gimp.xml"/> -->
<!--   <import file="Inkscape.xml"/> -->
<!--   <import file="SubRecursive.xml"/> -->
<!--   <import file="ExerciseSubmit.xml"/> -->
<!--   <import file="Pdflatex.xml"/> -->
<!--   <import file="PDFnup.xml"/> -->
<!--   <import file="Msf2PDF.xml"/> -->
<!--   <import file="Ps2pdf.xml"/> -->
<!--   <import file="Rss.xml"/> -->
<!--   <import file="Scp.xml"/> -->
<!--   <import file="TestExam.xml"/> -->
<!--   <import file="Xfig.xml"/> -->

<!--   <import file="Rsync.xml"/> -->

  <macrodef name="ada.apply.processing.rules">
    <sequential>
      <ant antfile="${ada.home}/AntImports/Copyfiles.xml"
	   target="copyfiles.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/ExtraAnt.xml"
	   target="extraant.processing.pretarget" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Xfig.xml"
	   target="xfig.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Inkscape.xml"
	   target="inkscape.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Gimp.xml"
	   target="gimp.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Convert.xml"
	   target="convert.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Xsltproc.xml"
	   target="xsltproc.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Xsltproc.xml"
	   target="xsltprocmultilingual.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/ExerciseSubmit.xml"
	   target="exercisesubmit.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Exam.xml"
	   target="exam.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/TestExam.xml"
	   target="testexam.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Rss.xml"
	   target="rss.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Latex.xml"
	   target="latex.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Dvips.xml"
	   target="dvips.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Ps2pdf.xml"
	   target="ps2pdf.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Pdflatex.xml"
	   target="pdflatex.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Dblatex.xml"
	   target="dblatex.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Msf2PDF.xml"
	   target="msf2pdf.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/PDFnup.xml"
	   target="pdfnup.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/ExtraAnt.xml"
	   target="extraant.processing.posttarget" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>

      <ant antfile="${ada.home}/AntImports/Export.xml"
	   target="export.processing" inheritAll="false">
	<property name="ada.course.home.candidate" value="${ada.course.home}"/>
      </ant>
    </sequential>
  </macrodef>

  <target name="local.execute"
	  depends="ada.init, initial.delete.build.out">

    <echo>BEGIN ${basedir}</echo>
    <echo file="${user.dir}/adado.log" append="true">ADA_BEGIN_EXE ${basedir}${line.separator}</echo>

    <ada.apply.processing.rules/>

    <echo>END ${basedir}</echo>
    <echo file="${user.dir}/adado.log" append="true">ADA_END_EXE ${basedir}${line.separator}</echo>
  </target>

  <!-- Apply timeline -->
  <target name="execute" depends="ada.init, initial.delete.build.out">

    <echo>BEGIN ${basedir}</echo>
    <echo file="${user.dir}/adado.log" append="true">ADA_BEGIN_EXE ${basedir}${line.separator}</echo>

    <ant antfile="${ada.home}/AntImports/SubRecursive.xml"
	 target="subrecursive.processing" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ada.apply.processing.rules/>

    <echo>END ${basedir}</echo>
    <echo file="${user.dir}/adado.log" append="true">ADA_END_EXE ${basedir}${line.separator}</echo>
  </target>

  <target name="local.clean" depends="ada.init, initial.delete.build.out">

    <echo>BEGIN CLEAN: ${basedir}</echo>

    <ant antfile="${ada.home}/AntImports/Export.xml"
	 target="export.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/ExtraAnt.xml"
	 target="extraant.processing.posttarget.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/PDFnup.xml"
	 target="pdfnup.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Msf2PDF.xml"
	 target="msf2pdf.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Dblatex.xml"
	 target="dblatex.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Pdflatex.xml"
	 target="pdflatex.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Ps2pdf.xml"
	 target="ps2pdf.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Dvips.xml"
	 target="dvips.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Latex.xml"
	 target="latex.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Rss.xml"
	 target="rss.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/TestExam.xml"
	 target="testexam.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Exam.xml"
	 target="exam.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/ExerciseSubmit.xml"
	 target="exercisesubmit.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Xsltproc.xml"
	 target="xsltprocmultilingual.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Xsltproc.xml"
	 target="xsltproc.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Convert.xml"
	 target="convert.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Gimp.xml"
	 target="gimp.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Inkscape.xml"
	 target="inkscape.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Xfig.xml"
	 target="xfig.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/ExtraAnt.xml"
	 target="extraant.processing.pretarget.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Copyfiles.xml"
	 target="copyfiles.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

  </target>

  <target name="redo" depends="clean, execute"/>

  <target name="clean" depends="local.clean">

    <ant antfile="${ada.home}/AntImports/SubRecursive.xml"
	 target="subrecursive.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Export.xml"
	 target="export.garbage.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <ant antfile="${ada.home}/AntImports/Cleaning.xml"
	 target="clean.clean" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>END CLEAN: ${basedir}</echo>

  </target>

  <target name="report">

    <!-- Load the general properties from ada.home directory -->
    <property
      file="${ada.home}${file.separator}bin${file.separator}ada_general_definitions.txt"/>

    <ant antfile="${ada.home}/AntImports/InitialCheck.xml"
	 target="ada.properties.init.dump">
      <property name="ada.debug.level" value="warning"/>
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo/>

    <echo>              Summary of available functionality             </echo>
    <echo>-------------------+-----------+-----------------------------</echo>
    <echo>Tool               | Installed |  Missing</echo>
    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Xfig.xml"
	 target="xfig.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Inkscape.xml"
	 target="inkscape.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Gimp.xml"
	 target="gimp.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Convert.xml"
	 target="convert.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Xsltproc.xml"
	 target="xsltproc.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Latex.xml"
	 target="latex.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Dvips.xml"
	 target="dvips.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Ps2pdf.xml"
	 target="ps2pdf.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Pdflatex.xml"
	 target="pdflatex.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/Dblatex.xml"
	 target="dblatex.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

    <ant antfile="${ada.home}/AntImports/PDFnup.xml"
	 target="pdfnup.report" inheritAll="false">
      <property name="ada.course.home.candidate" value="${ada.course.home}"/>
    </ant>

    <echo>-------------------+-----------+-----------------------------</echo>

  </target>

</project>
